<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title></title>
<link type="text/css" rel="stylesheet" href="css/header_footer.css" />
<link rel="stylesheet" type="text/css" href="css/normalize.css" />
<link rel="stylesheet" type="text/css" href="css/component.css" />
<link rel="stylesheet" type="text/css" href="css/competition.css" />


<link rel="stylesheet" href="css/tos/tos.css" />
<link rel="Shortcut Icon" href="http://s.nx.com/s2/game/tos/common/farvicon.ico" type="image/x-icon" />
<link rel="icon" href="http://s.nx.com/s2/game/tos/common/farvicon.ico" type="image/x-icon" />

<style>
#lean_overlay {
    position: fixed;
    z-index:100;
    top: 100px;
    left: 0px;
    height:100%;
    width:100%;
    background: #000;
    display: none;
}
#detail {
  background-color: #000;
  bottom: 0;
  left: 0;
  opacity: 0.5;
  filter: alpha(opacity = 50);
  /* IE7 & 8 */ position: fixed;
  right: 0;
  top: 0;
  z-index: 99;
  display:none;
}
</style>
<script src="js/jquery-1.11.3.js"></script>
<script src="js/jquery.leanModal.min.js"></script>
<script src="js/modernizr.min.js"></script>


<script> 
var pageSize = 7;
$(function(){
  $("#header").load("header.html"); 
  $("#footer").load("footer.html"); 
});

$(function() {
    $('a[rel*=leanModal]').leanModal({ top : 200, closeButton: ".modal_close" });   
});

</script> 
<script type="text/javascript" src="js/jquery.session.js"></script>
</head>
<body>
<div id="header"></div>
<div style="height:100px;"></div>

<div id="container">
<div id="content">
  <div class="boardContents boardList">
    <div class="innerWrap">

      <div class="listWrap">

        <div class="listHeader clearFix">
          <h2 class="snbTitSub tit">종목별 게시판</h2>
          <div class="sort">
            <ul class="list">
              <li><a href="#"  class='on'>최신순</a></li>
              <li><a href="#"  >댓글순</a></li>
              <li><a href="#"  >좋아요순</a></li>
            </ul>
          </div>
        </div>
        
        <div class="boardList listType1">

          <table id="boardtable">
            <caption>게시판 리스트</caption>

            <thead>
              <tr>
                <th class="th1" scope="col">종목</th>
                <th class="th2" scope="col">제목</th>
                <th class="th3" scope="col">작성자</th>
                <th class="th4" scope="col">조회</th>
              </tr>
            </thead>

          </table>
          
        </div>
        
        
        <div class="btnArea clearFix">
          <p class="fR">
                        
              <a id="newBtn"  class="btn btnType1 btnWrite">글쓰기</a>
                        
          </p>
        </div>
        <div class="paging">
        <!-- 페이징 처리 부분 -->
        </div> 
        <fieldset class="searchArea">
          <select name="ctl00$Contents$selSearch" id="ctl00_Contents_selSearch">
  <option value="1">제목</option>
  <option value="2">작성자</option>
</select>
          <input name="ctl00$Contents$inputSrch" type="text" id="ctl00_Contents_inputSrch" class="inputTxt" />
                    <input type="submit" name="ctl00$Contents$SearchClick" value="검색" onclick="return search();" id="ctl00_Contents_SearchClick" class="btnSearch btn" />
                    
        </fieldset>
      </div>
    </div>
  </div>
</div>
</div>

            <div id="contents" style='display:none; background-color: white; min-width:1258px; margin:auto; overflow:auto;'>
          <div class="viewWrap boardContents boardView" style="width:100%; overflow-y:auto;">
              <article id="subject" class="mainArea">
             
              </article>
              <aside id="rightSide" class="sideArea">
                
              </aside>


            </div>
          </div>
<!-- 새 글 작성 시작 -->
<div id="newWrite" style='display:none; border:1px black solid; background-color: white; min-width:1024px; margin:auto; overflow:auto;'>
  <div style="margin:5% 0px 20px 81px;">
    <p style="font-size: 25px;">종목별 게시판</p>
  </div>
  <div id="newBoard" style="width:100%; overflow-y:auto;">

  </div>
  <div>
    <div style="margin:2% 81px 4% 750px;">
      <button id='addBtn' type='button' style="margin-bottom: 40px;"
        class="newForm btn btn-primary btn-xs">등록</button>
    </div>
  </div>
</div>
<!-- 새 글 작성 끝 -->
<div id="footer"></div>

<script>
var pageNo = 1;
if (location.href.indexOf('?') != -1)
  pageNo = location.href.split('?')[1].split('=')[1];
$.getJSON('/allstar/board/ajax/list.do?pageSize=' + pageSize + '&pageNo=' + pageNo, function(resultObj) {
  var table = $("#boardtable");
  console.log("list.do")
  for (var board of resultObj.boards) {
    $("<tr>")
    .html("<td class='num'>"+ board.event.name +"</td>"
    		  + "<td class='subject'>"
    		  + "<a href='#contents' class='trigger'  rel='leanModal'  boardBno='"+ board.no +"'>"
    		  + board.title  
    		  + "<small>("+ board.views +")</small>" 
    		  +"<img src='http://s.nx.com/s2/game/tos/obt/common/bullet/bul_img.png' alt='이미지 있음' class='bulArticle bulImg' />" 
    		  +"<img class='bul' src='http://s.nx.com/s2/game/tos/obt/common/bullet/bul_new.png' alt='새 글' class='bulArticle bulNew'>"
    		  + "<span class='info'>"+ board.createDate +"</span></a>"
    		  + "</td>"
    		  +"<td class='author'>"
    		  +"<p class='img'>"
    		  +"<img src='"+ board.member.photo + "' alt='프로필사진' />" 
    		  +"</p>"
    		  +"<a href='#' onclick='window.open('/barrack/guest.aspx?n8NexonSN=973206215&n8CharacterSN=24146306139339', 'barrack', 'width=1200. height=665, scrollbars=no');'>"
    		  +"<div class='contents'>"
    		  +"<p class='name'>"
    		  +"<span class='nameChar'>" + board.member.name +"</span>"

    		  +"</div>"
    		  +"</a>"
    		  +"</td>"
    		  +"<td class='cnt'>"
    		  +"<span class='view'><strong>"+ board.views +"</strong>조회</span>"
    		  +"<span class='like'><strong>"+0+"</strong>좋아요</span>"
    		  +"</td>")
    .appendTo(table);
    
  }
  $("a.trigger").click(clickDetailLnk);
  $('#newBtn').click(clickNewWrite);
});
</script>

<!-- 페이징 -->
<script>
var totalPage = 1;
$.getJSON('../board/ajax/all.do', function(resultObj) {
	  var ajaxResult = resultObj.ajaxResult;
	  totalPage = Math.ceil(resultObj.ajaxResult.data / pageSize);
    var lp10 = Math.floor((totalPage - 1) / 10) * 10;
    var start = Math.floor((pageNo - 1) / 10) * 10 + 1;
    var end = start + 10;
    
    if (end > totalPage)
      end = totalPage + 1;
    
    var pagingDiv = $('.paging');

    /* <<, < 버튼 추가 */
    if (start < 11) {
      $("<span>").addClass('fir').appendTo(pagingDiv);
      $("<span>").addClass('prev').appendTo(pagingDiv);
    }
    else {
      $("<a>").addClass('fir').attr({href:'#'}).appendTo(pagingDiv);
      $("<a>").addClass('prev').attr({href:'#'}).appendTo(pagingDiv);
      $('a.fir').click(clickFir);
      $('a.prev').click(clickPrev);
    }
    
    /* 숫자 */
    var pageDiv = $('<div>').addClass('page_num');
    pageDiv.appendTo(pagingDiv);
    for (var i = start ; i < end ; i++) {
      if(i == pageNo) {
        $("<span>").addClass('nowpage')
        .html("<b>"+ i + "</b>").appendTo(pageDiv); 
      } else {
        $("<a>")
        .addClass('a_pageNo')
        .attr({
          href : '#',
          pageno : i
          })
        .html(i).appendTo(pageDiv);
      }
    };
    $(".a_pageNo").click(clickPageNo)
    
    /* >, >> 버튼 추가 */
    if (pageNo > lp10) {
      $("<span>").addClass('next').appendTo(pagingDiv);
      $("<span>").addClass('end').appendTo(pagingDiv);
    }
    else {
      $("<a>").addClass('next').attr({href:'#'}).appendTo(pagingDiv);
      $("<a>").addClass('end').attr({href:'#'}).appendTo(pagingDiv);
      $('a.next').click(clickNext);
      $('a.end').click(clickEnd);
    }
});

//페이징 번호를 클릭했을 때 호출될 함수
function clickPageNo(event) {
  event.preventDefault();
  location.href = "boardList12.html?pageNo=" + $(event.target).attr("pageno");
}

//<<버튼을 클릭했을 때 호출될 함수
function clickFir() {
  event.preventDefault();
  location.href = "boardList12.html";
}

//<버튼을 클릭했을 때 호출될 함수
function clickPrev() {
  event.preventDefault();
  var no = Math.floor((pageNo - 11) / 10) * 10 + parseInt(1);
  location.href = "boardList12.html?pageNo=" + no;
}

//>버튼을 클릭했을 때 호출될 함수
function clickNext() {
  event.preventDefault();
  var no = Math.floor((pageNo*1 + parseInt(9)) / 10) * 10 + parseInt(1);
  location.href = "boardList12.html?pageNo=" + no;
}

//>>버튼을 클릭했을 때 호출될 함수
function clickEnd() {
  event.preventDefault();
  location.href = "boardList12.html?pageNo=" + totalPage;
}
</script>

<script>
/* board detail 시작 */
function clickDetailLnk(event) {
$('#subject').empty();
$('#rightSide').empty();
  $.getJSON('../board/ajax/detail.do?no=' + $(event.target).attr("boardBno"), function(resultObj) {
	    var ajaxResult = resultObj.ajaxResult;
	    var board = ajaxResult.data;
	      var article = $("#subject");
	        $("<header id='test1'class='header'>")
	        .html("<p class='cat1 clearFix'><span class='dep1'>종목별 게시판</span></p>"
	              + "<div class='inner clearFix'>"
	              + "<div class='subject'>"
	              + "<h2 class='tit'>" + board.title + "</h2>"
	              + "<p class='etc'><span class='date'>" + board.createDate + "</span></p>"
	              + "</div>"
	              + "<p class='cnt'>"
	              + "<span class='view'><strong>" + board.views + "</strong>조회</span>"
	              + "</p></div></header>")
	        .appendTo(article);
	        $("<div id='test2' class='viewContents'>")
	        .html("<p>" + board.content + "</p>"
	              + "<div id='loading' style='display:none'><img src='http://s.nx.com/s2/game/tos/common/img_loading.gif' alt='' /></div>" 
	              + "</div>")
	        .appendTo(article);
	        var aside = $("#rightSide");
	        $("<h3 class='blind'>글쓴이 정보</h3><div class='info clearFix'>")
	        .html("<p class='img'><img src='http://s.nx.com/s2/game/tos/obt/common/1006.png' alt='프로필 사진'>"
	              + "</p><div class='contents'><p class='name'>" + board.member.name 
	              + "</p><p class='lvs'><span class='lv'> 축구 </span></p></div></div>")
	              .appendTo(aside);
	        $("<div class='btnArea'>")
	        .html("<p class='btnHome'><a href='#' style='margin-left:0%' onclick='window.open('/barrack/guest.aspx?n8NexonSN=184613159&n8CharacterSN=87990995043730', 'barrack', 'width=1200. height=665, scrollbars=no');' class='btn btnType5'>회원정보보기</a></p>"
	              + "<div class='btm clearFix' style='margin-left:0%'>"
	              + "<a href='http://tos.nexon.com/community/free/write.aspx?n4ArticleSN=0' style='margin-left:0%' id='btnArticleWrite' class='btn btnType6 btnWrite'>글쓰기</a>"
	              + "<a href='http://tos.nexon.com/community/free/list.aspx?n4ArticleSN=0' style='margin-left:0%' class='btn btnType6 btnList'>목록</a>"
	              + "</div></div>")
	              .appendTo(aside);
	        $("<div class='history' >")
	        .html("<ul class='list' style='margin-left: -39px;'>"
	              + "<li class='prev'>"
	              + "<a href='http://tos.nexon.com/community/free/view.aspx?n4ArticleSN=88184'>"
	              + "<span class='nav'>이전<span class='bul sprBtn'></span></span>"
	              + "<div class='contents'>"
	              + "<strong class='tit'>test05</strong>"
	              + "<span class='etc'><span class='date'>2016.01.14</span></span>"
	              + "</div></a></li>"
	              + "<li class='next'>"
	              + "<a href='http://tos.nexon.com/community/free/view.aspx?n4ArticleSN=88182'>" 
	              + "<span class='nav'>다음<span class='bul sprBtn'></span></span>" 
	              + "<div class='contents'>" 
	              + "<strong class='tit'>test07</strong>" 
	              + "<span class='etc'><span class='date'>2016.01.14</span></span>" 
	              + "</div></a></li></ul></div>")
	      .appendTo(aside);
	  });
  
}
/* board detail 끝 */
</script>

<script>
/* 새 글 작성 시작 */
function clickNewWrite(event) {
	console.log($.session.get("mem_num"));
	if ($.session.get("mem_num") != undefined) {

	$('#newBoard').empty();
	$.getJSON('../board/ajax/add.do?no=' + -1, function(resultObj) {
		var fbevent = resultObj.eno;
		var div = $("#newBoard");
		$("<div style='margin-top:20px; margin-bottom:5%; height:35px;'>")
		.html("<div>"
				 +"<select id='feno' style='margin-left:81px; margin-right:0px; height:35px;'>"
				 +"<option value='2'>농구</option>"
				 +"<option value='3'>축구</option>"
				 +"<option value='4'>야구</option>"
				 +"<option value='5'>볼링</option>"
				 +"<option value='6'>탁구</option>"
				 +"</select>"
				 +"<input type='text' id='ftitle' placeholder='제목을 입력하세요.' style='width: 780px; height:35px; border-top:0px; border-left:0px; border-right:0px; border-bottom:1px solid black; padding:0px 0px 0px 0px;'>"
				 +"</div></div>")
		.appendTo(div);
		$("<div style='display:none;'>")
    .html("<label for='fmno' class='col-sm-2 control-label'>멤버번호</label>"
    		  +"<div class='col-sm-10'>"
		      +"<input type='text' class='form-control' id='fmno' value='"+$.session.get("mem_num")+"' readonly>"
		      +"</div></div>")
    .appendTo(div);
		
		$("<div>")
		.html("<div style='margin-left:81px; maring-right:81px;'>"
				  +"<textarea id='fcontent' class='form-control' rows='20' cols='60'"
				  +"placeholder='내용을 입력하세요.' style='width:840px; overflow-y: auto;'></textarea>"
				  +"</div></div>")
		.appendTo(div);     		 
	});
	} else {
		  		alert("로그인 후 게시글 작성이 가능합니다.");
	}
};

/* 새 글 작성 끝 */
</script>

<script>
// 등록 버튼을 위한 이벤트 리스너 추가하기
$('#addBtn').click(function(event) {
  console.log("eno = " + $('#feno').val());
  console.log("mno = " + $('#fmno').val());
  console.log("title = " + $('#ftitle').val());
  console.log("content = " +$('#fcontent').val());
  $.post('../board/ajax/add.do', {
    eno: $('#feno').val(),
    mno: $('#fmno').val(),
    title: $('#ftitle').val(),
    content: $('#fcontent').val(),
    
  }, function(resultObj) {
    var ajaxResult = resultObj.ajaxResult;
    if (ajaxResult.status == "success") {
      location.href = "../ui/boardList12.html";
    } else {
        alert("게시물 등록에 실패했습니다.");
    }
  }, 'json');
});



$(document).ready(function() {
  if ($.session.get("mem_num") != undefined) {
      console.log("글쓰기 버튼 활성화.");
    $('#newBtn').attr({
    rel : 'leanModal',
    href : '#newWrite'
  });
  }
  
 if ($.session.get("mem_num") == undefined) {
        console.log("글쓰기 버튼 비활성화.");
      $('#newBtn').attr({
      rel : '',
      href : ''
    });
    }
});
</script>



</body>
</html>