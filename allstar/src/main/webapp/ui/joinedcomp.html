<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<link rel="stylesheet" type="text/css" href="css/tos/comp.css" />
<style>
#team_information span {
font-size: 25px;
margin:30px;
}

#member_photo {
width:391px; 
height:600px; 
border: 1px black solid;
float:right;
overflow-y: auto;
}

#member_photo img {
width:150px;
height:155px;
}

#member_photo p {
width:162px; 
height:190px; 
float: left; 
margin-left: 22px;
}
#member_photo label {
text-align:center;
    color: indigo;
    font-size: 20px;
}

#team_btfld {
border: 1px black solid;
width:394px;
height:280px;
float:right;
margin-top: 0px;
}
#team_information {
width:380px; 
height:923px; 
border: 1px black solid;
}

#lean_overlay {
    position: fixed;
    z-index:100;
    top: 100px;
    left: 0px;
    height:100%;
    width:100%;
    background: #000;
    display: none;
}
#stateChange {
background-color:white;
display: none;
}
#stateChange img {
width:200px;
height:250px;
}

#stateChange ul {
padding: 45px;
}
#stateChange button {
margin: 10px;
}
</style>

<script src="js/test/modernizr.custom.js"></script>


</head>
<body>

	<div>
		
		<div class="container demo-3">
			<!-- Top Navigation -->

			<ul class="grid cs-style-4" id="myteams" style="">
        

			</ul>
			<ul class="grid cs-style-4" id="myteams_info" style="display:none">
			 <h2 style="text-align: center;">내가 참가한 대회</h2>
        <li id='team_name'></li>
        <li id='member_photo'></li>
        <li id='team_btfld'></li>
        <li id='team_information'></li>
      </ul>
		</div>
		<!-- /container -->
		
		<!-- <script src="js/test/toucheffects.js"></script> -->

	</div>
	
	<!-- state 변경 모달 -->
    <div id="stateChange" ></div>
	<!-- 풋터크기 -->
    <div style="height:150px;"></div>
<script>
function getCompetitionInfo(cno, tno){
	$.getJSON('../competition/detail.do?no=' + cno, function(resultObj){
	    var ajaxResult = resultObj.ajaxResult;
	    var c = ajaxResult.data;
	    var li = $('#team_name');
	    $("<div style='text-align:center; border: 1px black solid;'>")
	    .html("<h1>"+c.name+"</h1></div>").appendTo(li);
	    li= $('#team_btfld');
	    $("<p>")
	    .html("<button>버튼</button>"
	        +"<button>버튼</button></p>").appendTo(li);
	    
	    
	    li = $('#team_information');
	    var poster = c.poster;
	    if(poster == null)
	      emblem = "allstardefault.png";
	    $("<p>")
	    .html("<img style='width:350px; height:350px;' src='../competition/img/"+poster+"'><br>"
	        +"<span> 대회명 : "+c.name+"</span><br> <span></span><br>"
	        + "<span style='display: inherit;'> 종목 : " + c.event.name + " </span><br>"
	        + "<span style='display: inherit;'> 참여현황 : " + c.joinNum + "/" + c.teamNum + " </span><br>"
	        + "<span style='display: inherit;'> 모집일 : " + c.recruitStartDate + "~" + c.recruitEndDate + "</span><br>"
	        + "<span style='display: inherit;'> 대회일 : " + c.startDate + "~" + c.endDate + " </span><br>").appendTo(li);
	    });      
	    
   $.getJSON('../competition/jclist.do?cno=' + cno ,function(resultObj){
	   
	   if (resultObj.ajaxResult.status =='success'){
		   li = $('#member_photo');
	     for(var j of resultObj.ajaxResult.data) {
		     if(j.tno == tno){
		    	 $("<p>")
		         .html("<a href='#stateChange' rel='leanModal' teamNo='"+j.tno+"'  class='stateChan'>"
		        		 +"<img id='"+j.team.name+"' "
		             +"src='../team/img/"+j.team.emblem+"' >"
		             +"<label for='#"+j.team.tno+" '>"+j.team.name+" 개최팀</label></a>").prependTo(li);
		       }else {
		    	   $("<p>")
		           .html("<a href='#stateChange' rel='leanModal' teamNo='"+j.tno+"'  class='stateChan'>"
		        		   +"<img id='"+j.team.name+"' "
		               +"src='../team/img/"+j.team.emblem+"' >"
		               +"<label for='#"+j.team.tno+" '>"+j.team.name+"</label></a>").appendTo(li);
		         
		       } 
	     }
	   }
	   $('a[rel*=leanModal]').leanModal({ closeButton: ".modal_close" });
	   
	   $('.stateChan').click(function (event){
           $('#stateChange').empty();
           console.log("tNo: "+$(event.currentTarget).attr("teamNo"));
           var tno=$(event.currentTarget).attr("teamNo");
           
           //옮기기
           /* console.log("---------------");
           console.log($("#new_apply li[data-tno="+tno+"]"));
           var a =$("#new_apply li[data-tno="+tno+"]").clone();
           $("#new_apply li[data-tno="+tno+"]").remove();
           $("#reject_apply").append(a);
           console.log("---------------"); */
           
           /* 팀 상세 */
           $.getJSON('../team/ajax/detailncont.do?tno='+tno+'&cno='+cno, function(resultObj){
             
             var ajaxResult=resultObj.ajaxResult;
             if(ajaxResult.status=='success'){
               var team = ajaxResult.data.team;
               var div = $('#stateChange');
               console.log(team);
               $("<ul>")
               .html("<li><img src='../team/img/"+team.emblem+"'></li>"
                   +"<li><span>이름 : "+team.name+"</span></li>"
                   +"<li><span>인원수 : "+team.joinNum+"</span></li>"
                   +"<li><span>전적 : "+team.win+"승 "+team.lose+"패</span></li>"
                   +"<li><span>연고지 : "+team.baseAddr+"</span></li>"
                   +"<li><span>팀소개 : "+team.introduce+"</span></li>"
                   +"<li><span>참가내용 : "+ajaxResult.data.content+"</span></li>")
                   .appendTo(div);

             }
           });
      });
   });
}

$.getJSON('../competition/compJoined.do?mno=' +sessionStorage.getItem("mem_num"), function(resultObj) {
    $("myTeamInfo_detail").hide();
    var ul = $('#myteams');
    if(resultObj.ajaxResult.status == "success"){
    	var event = 0 ;
      for (var jc of resultObj.ajaxResult.data){
          switch(jc.competition.eno){
          case 2:  event = "농구";
             break;
          case 3:  event = "축구";
            break;
          case 4:  event = "야구";
            break;
          case 5:  event = "탁구";
            break;
          case 6:  event = "볼링";
            break;
          }
        console.log(jc);
        $("<li style='margin-left: 120px;'>")
        .html("<figure><div>"
            +"<img src='../competition/img/"+ jc.competition.poster + "' style='width:300px;' alt='"+ jc.competition.name+"'></div>"
            +"<figcaption>"
            +"<h3>" + jc.competition.name + "</h3>"
            +"<span>개최팀 : " + jc.team.name + "</span><br>"
            +"<span >개최지 : " + jc.competition.baseAddr + " </span><br>"
            +"<span >종목 : "+ event + " </span><br>"
            +"<span>내용 : "+ jc.competition.content + "</span><br>"
                  +"<a class='mycomp_info' href='javascript:;' data-comp-no='" + jc.cno + "' data-tno='" + jc.tno + "'>대회 정보 보기</a>"
            +"</figcaption></figure></li>"
        ).appendTo(ul);
      }
	      $('.mycomp_info').click(function(){
	      $("#myteams").hide();
	      $("#myteams_info").show();
	      getCompetitionInfo($(this).attr('data-comp-no'), $(this).attr('data-tno'));
      });
    } else {
    	$("<li>").html("현재 참가한 대회가 없습니다. </li>").appendTo(ul);
    }
});
	
</script>


</body>
</html>