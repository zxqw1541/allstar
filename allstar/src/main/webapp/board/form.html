<!DOCTYPE html>
<html>
<head>
  <meta charset='UTF-8'>
  <title>종목 게시판</title>
  <link rel="stylesheet" href="../lib/bootstrap/css/bootstrap.css">
  <link rel="stylesheet" type="text/css" href="../css/common.css">
</head>
<body>

<div class="container">        
<header>
종목 게시판 - 
  <a href="/allstar/auth/login.do">로그인</a>
</header>

<section>
<h1>게시물 폼</h1>

<form id='form1' class="form-horizontal">
  <div class="detailForm form-group">
    
  </div>
  <div class="form-group">
    <label for="ftitle" class="col-sm-2 control-label">제목</label>
    <div class="col-sm-10">
      <input type="text" class="form-control" id="ftitle" placeholder="제목">
    </div>
  </div>
  <div class="form-group">
    <label for="feno" class="col-sm-2 control-label">종목번호</label>
    <div class="col-sm-10">
      <input type="text" class="form-control" id="feno" placeholder="숫자">
    <!-- 
      <select id="fbevent"  >
        <option>농구</option>
        <option>축구</option>
        <option>야구</option>
        <option>배드민턴</option>
      </select><br>
       -->
    </div> 
  </div>
  <div class="form-group">
    <label for="fmno" class="col-sm-2 control-label">멤버번호</label>
    <div class="col-sm-10">
      <input type="text" class="form-control" id="fmno" placeholder="숫자">
    </div> 
  </div>
  <div class="form-group">
    <label for="fcontent" class="col-sm-2 control-label">내용</label>
    <div class="col-sm-10">
      <textarea id="fcontent" class="form-control" 
                rows='10' cols='60' placeholder="내용"></textarea>
    </div>
  </div>
  <div class="form-group">
    <label for="fcreateDate" class="col-sm-2 control-label">등록일</label>
    <div class="col-sm-10">
      <input type="date" class="form-control" id="fcreateDate" readonly>
    </div> 
  </div>
  <div class="form-group">
    <label for="fviews" class="col-sm-2 control-label">조회수</label>
    <div class="col-sm-10">
      <input type="text" class="form-control" id="fviews" placeholder="숫자" readonly>
    </div> 
  </div>
  
  <div class="form-group">
    <div class="col-sm-offset-2 col-sm-10">
      <button id='addBtn' type='button' 
        class="newForm btn btn-primary btn-xs">등록</button>
      <button id='updateBtn' type='button' 
        class="detailForm btn btn-primary btn-xs">변경</button>
      <button id='deleteBtn' type='button' 
        class="detailForm btn btn-primary btn-xs">삭제</button>
    </div>
  </div>
</form>
</section>

<footer>
<p><address>
** 이 웹 애플리케이션의 모든 권리는 Java76기에 있습니다. &copy; Java76. **
</address></p>
</footer>
</div><!-- container div -->

<script type="text/javascript" src="../lib/jquery/jquery.js"></script>
<script>
var no = location.href.split('?')[1].split('=')[1];

if (no < 0) { // 새 글 입력을 위한 폼으로 전환한다.
	$('.detailForm').css('display', 'none');// 상세정보 출력을 위한 폼 항목은 감춘다.
	$('.newForm').css('display', '');// 새 글 등록을 위한 폼 항목은 보인다.
  
} else { // 상세정보 출력폼으로 전환한다.
	$('.detailForm').css('display', '');
	$('.newForm').css('display', 'none');
	
	$.getJSON('ajax/detail.do?no=' + no, function(resultObj) {
		var ajaxResult = resultObj.ajaxResult;
		if (ajaxResult.status == "success") {
      var board = ajaxResult.data;
      $("#fno").val(no);
      $("#feno").val(board.eno);
      $("#fmno").val(board.mno);
      $("#ftitle").val(board.title);
      $("#fcontent").val(board.content);
      $("#fcreateDate").val(board.createDate);
      $("#fviews").val(board.views);
    }
	});
}

// 등록 버튼을 위한 이벤트 리스너 추가하기
$('#addBtn').click(function(event) {
	console.log("eno = " + $('#feno').val());
	console.log("mno = " + $('#fmno').val());
	console.log("title = " + $('#ftitle').val());
	console.log("content = " +$('#fcontent').val());
	console.log("views = " + $('#fviews').val() );
	$.post('ajax/add.do', {
		eno: $('#feno').val(),
		mno: $('#fmno').val(),
		title: $('#ftitle').val(),
		content: $('#fcontent').val(),
		
	}, function(resultObj) {
		var ajaxResult = resultObj.ajaxResult;
		if (ajaxResult.status == "success") {
      location.href = "index.html";
    } else {
        alert("게시물 등록에 실패했습니다.");
    }
	}, 'json');
});

//변경 버튼을 위한 이벤트 리스너 추가하기
$('#updateBtn').click(function(event) {
  $.post('ajax/update.do', {
	    no: no,
	    eno: $('#feno').val(),
	    mno: $('#fmno').val(),
	    title: $('#ftitle').val(),
	    content: $('#fcontent').val(),
	    createDate: $('#fcreateDate').val(),
	    
  }, function(resultObj) {
    var ajaxResult = resultObj.ajaxResult;
    if (ajaxResult.status == "success") {
      location.href = "index.html";
    } else {
        alert("게시물 변경에 실패했습니다.");
    }
  }, 'json');
});

//삭제 버튼을 위한 이벤트 리스너 추가하기
$('#deleteBtn').click(function(event) {
	$.getJSON('ajax/delete.do?no=' + no,
	  function(resultObj) {
	    var ajaxResult = resultObj.ajaxResult;
	    if (ajaxResult.status == "success") {
	      location.href = "index.html";
	    } else {
	        alert("게시물 삭제에 실패했습니다.");
	    }
  });
});

</script>
</body>
</html>