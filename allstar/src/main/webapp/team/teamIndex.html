<html>
<head>
<title></title>
<link type="text/css" rel="stylesheet" href="../ui/css/header_footer.css" />
<link rel="stylesheet" type="text/css" href="../ui/css/normalize.css" />
<link rel="stylesheet" type="text/css" href="../ui/css/component.css" />

<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" type="image/x-icon" href="images/fav-icon.png" />
<!----webfonts---->
<link href='//fonts.googleapis.com/css?family=Open+Sans:400,300,600,700,800' rel='stylesheet' type='text/css'>
<!----//webfonts---->
<link rel="stylesheet" href="css/main.css">

<script src="../ui/js/jquery-1.7.2.min.js"></script>
<script src="../ui/js/jquery.leanModal.min.js"></script>
<script src="../ui/js/modernizr.min.js"></script>
<script src="../ui/js/superfish.js"></script>
<script src="../ui/js/jquery.equalheights.js"></script>
<script src="../ui/js/jquery.easing.1.3.js"></script>
<script src="../ui/js/jquery.ui.totop.js"></script>

<script> 
/* $(function(){
  $("#header").load("header.html"); 
  $("#footer").load("footer.html"); 
}); */
</script> 
</head>
<body>
<div id="header"></div>
<div id="space"></div>

<!---start-content---->
<div class="content">
  <div class="wrap">
    <div id="main" role="main">
      <ul id="tiles">
        <!-- These are our grid blocks -->
        <!-- End of grid blocks -->
      </ul>
    </div>
  </div>
</div>
<div id="footer"></div>
  <!---//End-content---->
  <!----wookmark-scripts---->
  <script src="js/jquery.imagesloaded.js"></script>
  <script src="js/jquery.wookmark.js"></script>
  <script type="text/javascript">
        (function ($){
          var $tiles = $('#tiles'),
              $handler = $('li', $tiles),
              $main = $('#main'),
              $window = $(window),
              $document = $(document),
              options = {
                autoResize: true, // This will auto-update the layout when the browser window is resized.
                container: $main, // Optional, used for some extra CSS styling
                offset: 20, // Optional, the distance between grid items
                itemWidth:280 // Optional, the width of a grid item
              },
              pageNo = 2;
              listSize = 0;
              $.getJSON('ajax/all.do', function(resultObj) {
                listSize = resultObj.size;
              });
              
          /**
           * Reinitializes the wookmark handler after all images have loaded
           */
          function applyLayout() {
            $tiles.imagesLoaded(function() {
              // Destroy the old handler
              if ($handler.wookmarkInstance) {
                $handler.wookmarkInstance.clear();
              }
    
              // Create a new layout handler.
              $handler = $('li', $tiles);
              $handler.wookmark(options);
            });
          }
          
          /**
           * When scrolled all the way to the bottom, add more tiles
           */
           function onScroll() {
        	   if ($(window).data('ajaxready') === false)
        	        return;
        	   
             if (listSize >= $('li', $tiles).length) {
                 // Check if we're within 100 pixels of the bottom edge of the broser window.
               var winHeight = window.innerHeight ? window.innerHeight : $window.height(), // iphone fix
                   closeToBottom = ($window.scrollTop() + winHeight > $document.height() - 500);
                 
               if (closeToBottom) {
                 $(window).data('ajaxready', false);

                 // Get the first then items from the grid, clone them, and add them to the bottom of the grid
                 $.getJSON('ajax/list.do?pageNo=' + pageNo, function(resultObj) {
                     if (resultObj.teams.length != 0) {
                         pageNo++;
                         var tiles = $("#tiles");
                         for (var team of resultObj.teams) {
                           $( "<li>" )
                           .html("<img src='img/b1.jpg' width='280'>" + 
                                 "<div class='post-info'>" + 
                                   "<div class='post-basic-info'>" + 
                                       "<h3><a href='#'>" + team.name + "</a></h3><span>" +
                                     "<a href='#'>" + "<label></label>" + "by 팀장명" + "</a></span>" +
                                     "<p>" + team.event.name + "</p>" + 
                                     "<p>" + team.joinNum + " / " + team.totalNum +
                                     "</p></div>" + 
                                   "<div class='post-info-rate-share'>" + 
                                     "<div class='post-share'>" + 
                                       "<span></span></div>" + 
                                     "<div class='rateit'><span></span></div>" +
                                     "<div class='clear'></div></div></div>")
                           .appendTo(tiles);
                         }
                     }
                 });
                 setTimeout(function() {
                   $(window).data('ajaxready', true);
                   applyLayout();
                 }, 500);
               }
             }
           };
            
          // Call the layout function for the first time
          applyLayout();
    
          // Capture scroll event.
          $window.bind('scroll.wookmark', onScroll);

        })(jQuery);
      </script>
  <!----//wookmark-scripts---->

  <script>
  $.getJSON('ajax/list.do', function(resultObj) {
      var tiles = $("#tiles");
      for (var team of resultObj.teams) {
        $( "<li>" )
        .html("<img src='img/b2.jpg' width='280'>" + 
              "<div class='post-info'>" + 
                "<div class='post-basic-info'>" + 
                    "<h3><a href='#'>" + team.name + "</a></h3><span>" +
                  "<a href='#'>" + "<label></label>" + "by 팀장명" + "</a></span>" +
                  "<p>" + team.event.name + "</p>" + 
                  "<p>" + team.joinNum + " / " + team.totalNum +
                  "</p></div>" + 
                "<div class='post-info-rate-share'>" + 
                  "<div class='rateit'><span></span></div>" +
                  "<div class='post-share'>" + 
                    "<span></span></div>" + 
                  "<div class='clear'></div></div></div>")
        .appendTo(tiles);
      }
      // 제목 링크에 클릭 이벤트 리스너를 등록한다.
      $("a.detailLnk").click(clickDetailLnk);
    });

    $('#newBtn').click(function(event){
      location.href = "form.html?tno=-1";
    });

    // 게시물 제목을 클릭했을 때 호출될 함수
    function clickDetailLnk(event) {
      event.preventDefault(); 
      location.href = "form.html?tno=" + $(event.target).attr("teamNo");
    }
  
    /*                  $.getJSON('../team/ajax/list.do?pageNo=' + pageNo, function(resultObj) {
    if (resultObj.teams.length != 0) {
        pageNo++;
        var tiles = $("#tiles");
        for (var team of resultObj.teams) {
          var emblem = team.emblem; 
            
            if(emblem == null){
              emblem = "allstardefault.png";
            }
          
            $( "<li>" )
            .html("<img src= '../team/img/" + emblem + "' width='280'>" +
                 "<div class='post-info'>" + 
                 "<div class='post-basic-info'>" + 
                 "<h3><a class='detailLnk' href='#' teamNo='" + team.tno + "'>" + team.name + "</a></h3><span>" +
                  "<a href='#'><label></label>" + "by 팀장" + "</a></span>" +
                  "<p>" + team.event.name + "</p>" + 
                  "<p>" + team.joinNum + " / " + team.totalNum +
                  "</p></div></div>")
          .appendTo(tiles);
        }
        // 팀 링크에 클릭 이벤트 리스너 등록
        $("a.detailLnk").click(clickDetailLnk);
    }
}); */

/*   $.getJSON('../team/ajax/list.do', function(resultObj) {
var tiles = $("#tiles");
console.log(resultObj.status);

}) .done(function(resultObj) {
  for (var team of resultObj.teams) {
    var emblem = team.emblem; 
  
    if(emblem == null){
      emblem = "allstardefault.png";
    }
  
    $( "<li>" )
    .html("<img src= '../team/img/" + emblem + "' width='280'>" +
          "<div class='post-info'>" + 
          "<div class='post-basic-info'>" + 
          "<h3><a class='detailLnk' href='#' teamNo='" + team.tno + "'>" + team.name + "</a></h3><span>" +
          "<a href='#'><label></label>" + "by 팀장" + "</a></span>" +
          "<p>" + team.event.name + "</p>" + 
          "<p>" + team.joinNum + " / " + team.totalNum + 
          "</p></div></div>")
    .appendTo(tiles);
  }
  // 팀 링크에 클릭 이벤트 리스너 등록
  $("a.detailLnk").click(clickDetailLnk);
});
*/  

  </script>
</body>
</html>