<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Team</title>
<link rel="stylesheet" href="../lib/bootstrap/css/bootstrap.css">
<link rel="stylesheet" href="../css/common.css">
</head>
<body>
	<div class="container">
		<section>
			<h1>Team</h1>

			<form id='form1' class="form-horizontal">
				<div class="form-group">
					<label for="fname" class="col-sm-2 control-label">팀명</label>
					<div class="col-sm-10">
						<input type="text" class="form-control" id="fname"
							placeholder="팀명을 입력해주세요."> <input type='hidden'
							class="form-control" id='ftno'>
					</div>
				</div>
				<div class="form-group">
					<label for="fevent" class="col-sm-2 control-label">종목</label>
					<div class="col-sm-10">
						<select id="fevent">
							<option value=''>종목선택</option>
							<option value='2'>농구</option>
						</select>
					</div>
				</div>
				<div class="detailForm form-group">
					<label for="fscore" class="col-sm-2 control-label">전적</label>
					<div class="col-sm-10">
						<input type="text" class="form-control" id="fscore" readonly>
					</div>
				</div>
				<div class="form-group">
					<label for="ftotalnum" class="col-sm-2 control-label">인원수</label>
					<div class="col-sm-10">
						<input type="text" class="form-control" id="ftotalnum"
							placeholder="인원수를 입력해주세요.">
					</div>
				</div>
				<div class="form-group">
					<label for="ffee" class="col-sm-2 control-label">회비</label>
					<div class="col-sm-10">
						<input type="text" class="form-control" id="ffee"
							placeholder="회비를 입력해주세요.">
					</div>
				</div>
				<div class="form-group">
					<label for="fmeetday" class="col-sm-2 control-label">정모요일</label>
					<div class="col-sm-10">
						<input type="text" class="form-control" id="fmeetday"
							placeholder="정모요일을 입력해주세요.">
					</div>
				</div>
				<div class="form-group">
					<label for="fpostno" class="col-sm-2 control-label">우편번호</label>
					<div class="col-sm-10">
						<input type="text" class="form-control" id="fpostno"
							placeholder="우편번호(숫자 5자리)를 입력해주세요.">
					</div>
				</div>
				<div class="form-group">
					<label for="faddr" class="col-sm-2 control-label">연고지</label>
					<div class="col-sm-10">
						<input type="text" class="form-control" id="faddr"
							placeholder="연고지를 입력해주세요.">
					</div>
				</div>
				<div class="form-group">
					<label for="fintroduce" class="col-sm-2 control-label">팀 소개</label>
					<div class="col-sm-10">
						<textarea id="fintroduce" class="form-control" rows='10' cols='60'
							placeholder="팀소개를 입력해주세요."></textarea>
					</div>
				</div>
				<div class="form-group">
					<label for="faform" class="col-sm-2 control-label">팀 가입양식</label>
					<div class="col-sm-10">
						<textarea id="faform" class="form-control" rows='10' cols='60'
							placeholder="팀 가입 양식을 입력해주세요."></textarea>
					</div>
				</div>

				<div class="form-group">
					<div class="col-sm-offset-2 col-sm-10">
						<button id='addBtn' type='button'
							class="newForm btn btn-primary btn-xs">등록</button>
						<button id='updateBtn' type='button'
							class="detailForm btn btn-primary btn-xs">변경</button>
						<button id='deleteBtn' type='button'
							class="detailForm btn btn-primary btn-xs">삭제</button>
					</div>
				</div>
			</form>
		</section>
	</div>

	<script type="text/javascript" src="../lib/jquery/jquery.js"></script>
	<script>
		var tno = location.href.split('?')[1].split('=')[1];

		if (tno < 0) { // 새 글 입력을 위한 폼으로 전환한다.
			$('.detailForm').css('display', 'none');// 상세정보 출력을 위한 폼 항목은 감춘다.
			$('.newForm').css('display', '');// 새 글 등록을 위한 폼 항목은 보인다.

		} else { // 상세정보 출력폼으로 전환한다.
			$('.detailForm').css('display', '');
			$('.newForm').css('display', 'none');

			$.getJSON('ajax/detail.do?tno=' + tno, function(
					resultObj) {
				var ajaxResult = resultObj.ajaxResult;
				if (ajaxResult.status == "success") {
					var team = ajaxResult.data;
					$("#ftno").val(team.tno);
					$("#fevent").val(team.eno);
					$("#fname").val(team.name);
					$("#ftotalnum").val(team.totalNum);
					$("#fscore").val(team.win+"승 "+team.draw+"무 "+team.lose+"패");
					$("#ffee").val(team.fee);
					$("#fmeetday").val(team.meetDay);
			    $("#fintroduce").val(team.introduce);
			    $("#faform").val(team.aForm);
			    $("#fpostno").val(team.postNo);
					$("#faddr").val(team.baseAddr);
				}
			});
		}

		// 등록 버튼을 위한 이벤트 리스너 추가하기
		$('#addBtn').click(function(event) {
			console.log($('#fevent').val());
			$.post('ajax/add.do', {
				eno : $('#fevent').val(),
				name : $('#fname').val(),
				totalNum : $('#ftotalnum').val(),
				fee : $('#ffee').val(),
				meetDay : $('#fmeetday').val(),
				introduce : $('#fintroduce').val(),
				aForm : $('#faform').val(),
				baseAddr : $('#faddr').val(),
				postNo : $('#fpostno').val()
			}, function(resultObj) {
				var ajaxResult = resultObj.ajaxResult;
				if (ajaxResult.status == "success") {
					location.href = "index.html";
				} else {
					alert("팀 등록에 실패했습니다.");
				}
			}, 'json');
		});

		//변경 버튼을 위한 이벤트 리스너 추가하기
		$('#updateBtn').click(function(event) {
			$.post('ajax/update.do', {
				tno: $('#ftno').val(),
				name: $('#fname').val(),
				totalNum: $('#ftotalnum').val(),
				fee: $('#ffee').val(),
				meetDay: $('#fmeetday').val(),
				introduce: $('#fintroduce').val(),
				aForm : $('#faform').val(),
				baseAddr : $('#faddr').val(),
				postNo : $('#fpostno').val()
			}, function(resultObj) {
				var ajaxResult = resultObj.ajaxResult;
				if (ajaxResult.status == "success") {
					location.href = "index.html";
				} else {
					alert("팀 정보 변경에 실패했습니다.");
				}
			}, 'json');
		});

		//삭제 버튼을 위한 이벤트 리스너 추가하기
		$('#deleteBtn').click(
				function(event) {
					$.getJSON('ajax/delete.do?tno='
							+ $('#ftno').val(), function(resultObj) {
						var ajaxResult = resultObj.ajaxResult;
						if (ajaxResult.status == "success") {
							location.href = "index.html";
						} else {
							alert("팀 삭제에 실패했습니다.");
						}
					});
				});
	</script>

</body>
</html>