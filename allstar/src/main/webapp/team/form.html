<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Team</title>
<link rel="stylesheet" href="../lib/bootstrap/css/bootstrap.css">
<link rel="stylesheet" href="../css/common.css">
</head>
<body>
	<div class="container">
		<section>
			<h1>Team</h1>

			<form id='form1' class="form-horizontal">
				<div class="form-group">
					<label for="fname" class="col-sm-2 control-label">팀명</label>
					<div class="col-sm-10">
						<input type="text" class="form-control" id="fname"
							placeholder="팀명을 입력해주세요."> <input type='hidden'
							class="form-control" id='fno'>
					</div>
				</div>
				<div class="form-group">
          <label for="fcaptain" class="col-sm-2 control-label">팀장</label>
          <div class="col-sm-10">
            <input type="text" class="form-control" id="fcaptain"
              placeholder="팀장을 입력해주세요.">
          </div>
        </div>
				<div class="form-group">
					<label for="fevent" class="col-sm-2 control-label">종목</label>
					<div class="col-sm-10">
						<input type="text" class="form-control" id="fevent"
							placeholder="종목을 입력해주세요.">
					</div>
				</div>
				<div class="form-group">
					<label for="fhometown" class="col-sm-2 control-label">연고지</label>
					<div class="col-sm-10">
						<input type="text" class="form-control" id="fhometown"
							placeholder="연고지를 입력해주세요.">
					</div>
				</div>
				<div class="form-group">
					<label for="ftotalnum" class="col-sm-2 control-label">인원수</label>
					<div class="col-sm-10">
						<input type="text" class="form-control" id="ftotalnum"
							placeholder="인원수를 입력해주세요.">
					</div>
				</div>
				<div class="form-group">
					<label for="ffee" class="col-sm-2 control-label">회비</label>
					<div class="col-sm-10">
						<input type="text" class="form-control" id="ffee"
							placeholder="회비를 입력해주세요.">
					</div>
				</div>
				<div class="form-group">
					<label for="fmeetday" class="col-sm-2 control-label">정모요일</label>
					<div class="col-sm-10">
						<input type="text" class="form-control" id="fmeetday"
							placeholder="정모요일을 입력해주세요.">
					</div>
				</div>
				<div class="detailForm form-group">
					<label for="fscore" class="col-sm-2 control-label">전적</label>
					<div class="col-sm-10">
						<input type="text" class="form-control" id="fscore" readonly>
					</div>
				</div>
				<div class="form-group">
					<label for="fintroduce" class="col-sm-2 control-label">팀 소개</label>
					<div class="col-sm-10">
						<textarea id="fintroduce" class="form-control" rows='10' cols='60'
							placeholder="팀소개를 입력해주세요."></textarea>
					</div>
				</div>
				<div class="form-group">
					<label for="faform" class="col-sm-2 control-label">팀 가입양식</label>
					<div class="col-sm-10">
						<textarea id="faform" class="form-control" rows='10' cols='60'
							placeholder="팀 가입 양식을 입력해주세요."></textarea>
					</div>
				</div>

				<div class="form-group">
					<div class="col-sm-offset-2 col-sm-10">
						<button id='addBtn' type='button'
							class="newForm btn btn-primary btn-xs">등록</button>
						<button id='updateBtn' type='button'
							class="detailForm btn btn-primary btn-xs">변경</button>
						<button id='deleteBtn' type='button'
							class="detailForm btn btn-primary btn-xs">삭제</button>
					</div>
				</div>
			</form>
		</section>
	</div>

	<script type="text/javascript" src="../lib/jquery/jquery.js"></script>
	<script>
		var no = location.href.split('?')[1].split('=')[1];

		if (no < 0) { // 새 글 입력을 위한 폼으로 전환한다.
			$('.detailForm').css('display', 'none');// 상세정보 출력을 위한 폼 항목은 감춘다.
			$('.newForm').css('display', '');// 새 글 등록을 위한 폼 항목은 보인다.

		} else { // 상세정보 출력폼으로 전환한다.
			$('.detailForm').css('display', '');
			$('.newForm').css('display', 'none');

			$.getJSON('ajax/detail.do?no=' + no, function(
					resultObj) {
				var ajaxResult = resultObj.ajaxResult;
				if (ajaxResult.status == "success") {
					var team = ajaxResult.data;
					$("#fno").val(team.no);
					$("#fname").val(team.name);
					$("#fcaptain").val(team.captain);
					$("#fevent").val(team.event);
					$("#fhometown").val(team.hometown);
					$("#ftotalnum").val(team.totalNum);
					$("#fscore").val(team.win+"승 "+team.draw+"무 "+team.lose+"패");
					$("#fmeetday").val(team.meetDay);
					$("#ffee").val(team.fee);
			    $("#fintroduce").val(team.introduce);
				}
			});
		}

		// 등록 버튼을 위한 이벤트 리스너 추가하기
		$('#addBtn').click(function(event) {
			$.post('ajax/add.do', {
				name : $('#fname').val(),
				captain : $('#fcaptain').val(),
				event : $('#fevent').val(),
				hometown : $('#fhometown').val(),
				totalNum : $('#ftotalnum').val(),
				fee : $('#ffee').val(),
				meetDay : $('#fmeetday').val(),
				introduce : $('#fintroduce').val()

			}, function(resultObj) {
				var ajaxResult = resultObj.ajaxResult;
				if (ajaxResult.status == "success") {
					location.href = "index.html";
				} else {
					alert("팀 등록에 실패했습니다.");
				}
			}, 'json');
		});

		//변경 버튼을 위한 이벤트 리스너 추가하기
		$('#updateBtn').click(function(event) {
			$.post('ajax/update.do', {
				no: $('#fno').val(),
				name: $('#fname').val(),
				captain: $('#fcaptain').val(),
				event: $('#fevent').val(),
				hometown: $('#fhometown').val(),
				totalNum: $('#ftotalnum').val(),
				fee: $('#ffee').val(),
				meetDay: $('#fmeetday').val(),
				introduce: $('#fintroduce').val()
				
			}, function(resultObj) {
				var ajaxResult = resultObj.ajaxResult;
				if (ajaxResult.status == "success") {
					location.href = "index.html";
				} else {
					alert("팀 정보 변경에 실패했습니다.");
				}
			}, 'json');
		});

		//삭제 버튼을 위한 이벤트 리스너 추가하기
		$('#deleteBtn').click(
				function(event) {
					$.getJSON('ajax/delete.do?no='
							+ $('#fno').val(), function(resultObj) {
						var ajaxResult = resultObj.ajaxResult;
						if (ajaxResult.status == "success") {
							location.href = "index.html";
						} else {
							alert("팀 삭제에 실패했습니다.");
						}
					});
				});
	</script>

</body>
</html>